{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import statistics"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "def convert_to_datetime_and_format(df, columns):\n",
    "    for column in columns:\n",
    "        df[column] = pd.to_datetime(df[column], errors='coerce').dt.strftime('%Y-%m-%d')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_mode(items):\n",
    "    \"\"\"\n",
    "    Define mode function for a list of items with two possible values.\n",
    "    based on which is mentioned more, or 'Multiple' if score is equal\n",
    "    \"\"\"\n",
    "    try:\n",
    "        r = statistics.mode(items)\n",
    "    except statistics.StatisticsError:\n",
    "        unique_values = set(items)\n",
    "        if len(unique_values) == 1:\n",
    "            r = unique_values.pop()\n",
    "        else:\n",
    "            r = 'Multiple'\n",
    "        print(\"Ошибка: не уникальное модальное значение. Значения:\", items)\n",
    "    except Exception as e:\n",
    "        print(\"Ошибка:\", e)\n",
    "        r = None\n",
    "    return r"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Определите регулярное выражение для соответствия строкам, содержащим только буквенные символы и пробелы\n",
    "alpha_only_pattern = '^[a-zA-Z]+$'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>journal</th>\n",
       "      <th>pmc_ID</th>\n",
       "      <th>accession</th>\n",
       "      <th>converted_accession</th>\n",
       "      <th>repository</th>\n",
       "      <th>Date</th>\n",
       "      <th>repository_date</th>\n",
       "      <th>species</th>\n",
       "      <th>hardware</th>\n",
       "      <th>library_strategy</th>\n",
       "      <th>sra_avg_length</th>\n",
       "      <th>sra_bases</th>\n",
       "      <th>sra_access</th>\n",
       "      <th>time_public</th>\n",
       "      <th>reuse_count</th>\n",
       "      <th>norm_reuse_count</th>\n",
       "      <th>pmc_date</th>\n",
       "      <th>reuse_role</th>\n",
       "      <th>pub_delay</th>\n",
       "      <th>class</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>mSphere</td>\n",
       "      <td>PMC10347838</td>\n",
       "      <td>PRJNA880698</td>\n",
       "      <td>SRP397411</td>\n",
       "      <td>SRA</td>\n",
       "      <td>2023/6/13</td>\n",
       "      <td>2022-09-16</td>\n",
       "      <td>Metopolophium dirhodum</td>\n",
       "      <td>Illumina HiSeq 2500</td>\n",
       "      <td>WGS</td>\n",
       "      <td>500.0</td>\n",
       "      <td>2.390947e+10</td>\n",
       "      <td>public</td>\n",
       "      <td>1.917808</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2023-06-13</td>\n",
       "      <td>G</td>\n",
       "      <td>270.0</td>\n",
       "      <td>SRA_other</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>J Clin Med</td>\n",
       "      <td>PMC8358774</td>\n",
       "      <td>GSE158847</td>\n",
       "      <td>GSE158847</td>\n",
       "      <td>GEO</td>\n",
       "      <td>2021/6/28</td>\n",
       "      <td>2020-10-01</td>\n",
       "      <td>Homo sapiens</td>\n",
       "      <td>high-throughput sequencing</td>\n",
       "      <td>RNA-Seq</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.876712</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2021-06-28</td>\n",
       "      <td>G</td>\n",
       "      <td>270.0</td>\n",
       "      <td>RNA-Seq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>PLoS Negl Trop Dis</td>\n",
       "      <td>PMC5054024</td>\n",
       "      <td>SRP065916</td>\n",
       "      <td>SRP065916</td>\n",
       "      <td>SRA</td>\n",
       "      <td>2016/9/16</td>\n",
       "      <td>2015-12-21</td>\n",
       "      <td>Zea mays</td>\n",
       "      <td>Illumina HiSeq 2000</td>\n",
       "      <td>RNA-Seq</td>\n",
       "      <td>200.0</td>\n",
       "      <td>2.583644e+09</td>\n",
       "      <td>public</td>\n",
       "      <td>8.660274</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2016-09-16</td>\n",
       "      <td>G</td>\n",
       "      <td>270.0</td>\n",
       "      <td>RNA-Seq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Front Neurosci</td>\n",
       "      <td>PMC4474661</td>\n",
       "      <td>SRP029217</td>\n",
       "      <td>SRP029217</td>\n",
       "      <td>SRA</td>\n",
       "      <td>2015/5/23</td>\n",
       "      <td>2014-08-26</td>\n",
       "      <td>flower metagenome</td>\n",
       "      <td>Illumina HiSeq 2000</td>\n",
       "      <td>RNA-Seq</td>\n",
       "      <td>99.0</td>\n",
       "      <td>4.112700e+09</td>\n",
       "      <td>public</td>\n",
       "      <td>9.980822</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2015-05-23</td>\n",
       "      <td>G</td>\n",
       "      <td>270.0</td>\n",
       "      <td>RNA-Seq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Genome Announc</td>\n",
       "      <td>PMC4474661</td>\n",
       "      <td>SRP029217</td>\n",
       "      <td>SRP029217</td>\n",
       "      <td>SRA</td>\n",
       "      <td>2015/5/23</td>\n",
       "      <td>2014-08-26</td>\n",
       "      <td>flower metagenome</td>\n",
       "      <td>Illumina HiSeq 2000</td>\n",
       "      <td>RNA-Seq</td>\n",
       "      <td>99.0</td>\n",
       "      <td>4.112700e+09</td>\n",
       "      <td>public</td>\n",
       "      <td>9.980822</td>\n",
       "      <td>0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2015-05-23</td>\n",
       "      <td>G</td>\n",
       "      <td>270.0</td>\n",
       "      <td>RNA-Seq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1114244</th>\n",
       "      <td>Eur Urol Open Sci</td>\n",
       "      <td>PMC11260452</td>\n",
       "      <td>ERR195223</td>\n",
       "      <td>ERP001824</td>\n",
       "      <td>SRA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-18</td>\n",
       "      <td>Homo sapiens</td>\n",
       "      <td>Illumina Genome Analyzer IIx</td>\n",
       "      <td>OTHER</td>\n",
       "      <td>20.0</td>\n",
       "      <td>2.481880e+06</td>\n",
       "      <td>public</td>\n",
       "      <td>11.583562</td>\n",
       "      <td>9</td>\n",
       "      <td>0.776963</td>\n",
       "      <td>NaN</td>\n",
       "      <td>R</td>\n",
       "      <td>NaN</td>\n",
       "      <td>SRA_other</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1114245</th>\n",
       "      <td>Cureus</td>\n",
       "      <td>PMC11260452</td>\n",
       "      <td>ERR195224</td>\n",
       "      <td>ERP001824</td>\n",
       "      <td>SRA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2013-01-18</td>\n",
       "      <td>Homo sapiens</td>\n",
       "      <td>Illumina Genome Analyzer IIx</td>\n",
       "      <td>OTHER</td>\n",
       "      <td>20.0</td>\n",
       "      <td>2.481880e+06</td>\n",
       "      <td>public</td>\n",
       "      <td>11.583562</td>\n",
       "      <td>9</td>\n",
       "      <td>0.776963</td>\n",
       "      <td>NaN</td>\n",
       "      <td>R</td>\n",
       "      <td>NaN</td>\n",
       "      <td>SRA_other</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1114246</th>\n",
       "      <td>ESMO Open</td>\n",
       "      <td>PMC11260452</td>\n",
       "      <td>GSM495500</td>\n",
       "      <td>GSE19836</td>\n",
       "      <td>GEO</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2010-12-06</td>\n",
       "      <td>Mus musculus</td>\n",
       "      <td>in situ oligonucleotide</td>\n",
       "      <td>Expression_Array</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>13.704110</td>\n",
       "      <td>13</td>\n",
       "      <td>0.948621</td>\n",
       "      <td>NaN</td>\n",
       "      <td>R</td>\n",
       "      <td>NaN</td>\n",
       "      <td>GEO_expr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1114247</th>\n",
       "      <td>Cureus</td>\n",
       "      <td>PMC11260452</td>\n",
       "      <td>GSM495500</td>\n",
       "      <td>GSE19836</td>\n",
       "      <td>GEO</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2010-12-06</td>\n",
       "      <td>Mus musculus</td>\n",
       "      <td>in situ oligonucleotide</td>\n",
       "      <td>Expression_Array</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>13.704110</td>\n",
       "      <td>13</td>\n",
       "      <td>0.948621</td>\n",
       "      <td>NaN</td>\n",
       "      <td>R</td>\n",
       "      <td>NaN</td>\n",
       "      <td>GEO_expr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1114248</th>\n",
       "      <td>Nucleic Acids Res</td>\n",
       "      <td>PMC11260452</td>\n",
       "      <td>GSM495500</td>\n",
       "      <td>GSE19836</td>\n",
       "      <td>GEO</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2010-12-06</td>\n",
       "      <td>Mus musculus</td>\n",
       "      <td>in situ oligonucleotide</td>\n",
       "      <td>Expression_Array</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>13.704110</td>\n",
       "      <td>13</td>\n",
       "      <td>0.948621</td>\n",
       "      <td>NaN</td>\n",
       "      <td>R</td>\n",
       "      <td>NaN</td>\n",
       "      <td>GEO_expr</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1114249 rows × 20 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                    journal       pmc_ID    accession converted_accession  \\\n",
       "0                   mSphere  PMC10347838  PRJNA880698           SRP397411   \n",
       "1                J Clin Med   PMC8358774    GSE158847           GSE158847   \n",
       "2        PLoS Negl Trop Dis   PMC5054024    SRP065916           SRP065916   \n",
       "3            Front Neurosci   PMC4474661    SRP029217           SRP029217   \n",
       "4            Genome Announc   PMC4474661    SRP029217           SRP029217   \n",
       "...                     ...          ...          ...                 ...   \n",
       "1114244   Eur Urol Open Sci  PMC11260452    ERR195223           ERP001824   \n",
       "1114245              Cureus  PMC11260452    ERR195224           ERP001824   \n",
       "1114246           ESMO Open  PMC11260452    GSM495500            GSE19836   \n",
       "1114247              Cureus  PMC11260452    GSM495500            GSE19836   \n",
       "1114248   Nucleic Acids Res  PMC11260452    GSM495500            GSE19836   \n",
       "\n",
       "        repository       Date repository_date                 species  \\\n",
       "0              SRA  2023/6/13      2022-09-16  Metopolophium dirhodum   \n",
       "1              GEO  2021/6/28      2020-10-01            Homo sapiens   \n",
       "2              SRA  2016/9/16      2015-12-21                Zea mays   \n",
       "3              SRA  2015/5/23      2014-08-26       flower metagenome   \n",
       "4              SRA  2015/5/23      2014-08-26       flower metagenome   \n",
       "...            ...        ...             ...                     ...   \n",
       "1114244        SRA        NaN      2013-01-18            Homo sapiens   \n",
       "1114245        SRA        NaN      2013-01-18            Homo sapiens   \n",
       "1114246        GEO        NaN      2010-12-06            Mus musculus   \n",
       "1114247        GEO        NaN      2010-12-06            Mus musculus   \n",
       "1114248        GEO        NaN      2010-12-06            Mus musculus   \n",
       "\n",
       "                             hardware  library_strategy  sra_avg_length  \\\n",
       "0                 Illumina HiSeq 2500               WGS           500.0   \n",
       "1          high-throughput sequencing           RNA-Seq             NaN   \n",
       "2                 Illumina HiSeq 2000           RNA-Seq           200.0   \n",
       "3                 Illumina HiSeq 2000           RNA-Seq            99.0   \n",
       "4                 Illumina HiSeq 2000           RNA-Seq            99.0   \n",
       "...                               ...               ...             ...   \n",
       "1114244  Illumina Genome Analyzer IIx             OTHER            20.0   \n",
       "1114245  Illumina Genome Analyzer IIx             OTHER            20.0   \n",
       "1114246       in situ oligonucleotide  Expression_Array             NaN   \n",
       "1114247       in situ oligonucleotide  Expression_Array             NaN   \n",
       "1114248       in situ oligonucleotide  Expression_Array             NaN   \n",
       "\n",
       "            sra_bases sra_access  time_public  reuse_count  norm_reuse_count  \\\n",
       "0        2.390947e+10     public     1.917808            0          0.000000   \n",
       "1                 NaN        NaN     3.876712            0          0.000000   \n",
       "2        2.583644e+09     public     8.660274            0          0.000000   \n",
       "3        4.112700e+09     public     9.980822            0          0.000000   \n",
       "4        4.112700e+09     public     9.980822            0          0.000000   \n",
       "...               ...        ...          ...          ...               ...   \n",
       "1114244  2.481880e+06     public    11.583562            9          0.776963   \n",
       "1114245  2.481880e+06     public    11.583562            9          0.776963   \n",
       "1114246           NaN        NaN    13.704110           13          0.948621   \n",
       "1114247           NaN        NaN    13.704110           13          0.948621   \n",
       "1114248           NaN        NaN    13.704110           13          0.948621   \n",
       "\n",
       "           pmc_date reuse_role  pub_delay      class  \n",
       "0        2023-06-13          G      270.0  SRA_other  \n",
       "1        2021-06-28          G      270.0    RNA-Seq  \n",
       "2        2016-09-16          G      270.0    RNA-Seq  \n",
       "3        2015-05-23          G      270.0    RNA-Seq  \n",
       "4        2015-05-23          G      270.0    RNA-Seq  \n",
       "...             ...        ...        ...        ...  \n",
       "1114244         NaN          R        NaN  SRA_other  \n",
       "1114245         NaN          R        NaN  SRA_other  \n",
       "1114246         NaN          R        NaN   GEO_expr  \n",
       "1114247         NaN          R        NaN   GEO_expr  \n",
       "1114248         NaN          R        NaN   GEO_expr  \n",
       "\n",
       "[1114249 rows x 20 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "table = pd.read_csv('../data/metadata_matrix_filtered.csv')\n",
    "table = table.rename(\n",
    "    columns={\n",
    "        \"sraBases\": \"sra_bases\",\n",
    "        \"sraAccess\": \"sra_access\",\n",
    "        \"sraAvg_length\": \"sra_avg_length\",\n",
    "        # \"Date\": \"pmc_date\"\n",
    "    }\n",
    ")\n",
    "table"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "187521"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "table['pmc_ID'].nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "solidbin",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
